# タスクリスト - 旅行ガイドブック作成・共有アプリ（Travue）

## 概要

- 総タスク数: 42タスク
- 推定作業時間: 12週間（240時間）
- 優先度: 高（MVP実装）

## タスク一覧

### Phase 1: 基盤実装（2週間）

#### Task 1.1: Flutter プロジェクト初期設定 ✅

- [x] Flutter プロジェクト作成（flutter create travue）
- [x] 基本的なディレクトリ構造の設定（lib/domain, lib/infrastructure, lib/presentation）
- [x] pubspec.yaml の設定（依存関係の追加）
- [x] flutter_lints の設定
- [x] Clean Architecture実装（Repository interfaces, Use Cases, Providers）
- **完了条件**: プロジェクトがビルド・実行可能 ✅
- **依存**: なし
- **推定時間**: 2時間
- **実績**: PR #1, #2で完了

#### Task 1.2: Supabase プロジェクトセットアップ ✅

- [x] Supabase プロジェクトの作成
- [x] 環境変数の設定（.env ファイル）
- [x] Supabase Flutter SDK の統合
- [x] 接続テストの実装
- **完了条件**: Supabaseとの接続が確認できる ✅
- **依存**: Task 1.1
- **推定時間**: 3時間
- **実績**: PR #1で完了

#### Task 1.3: データベーススキーマ実装 ✅

- [x] PostgreSQL + PostGIS の有効化確認
- [x] 全テーブルの作成（users, landmarks, posts, guides等）
- [x] インデックスの作成
- [x] 空間検索関数の実装
- **完了条件**: 全テーブルと関数が作成完了 ✅
- **依存**: Task 1.2
- **推定時間**: 4時間
- **実績**: PR #1で完了

#### Task 1.4: Row Level Security (RLS) 設定

- [ ] 各テーブルのRLSポリシー作成
- [ ] 権限テストの実装
- [ ] セキュリティルールのドキュメント化
- **完了条件**: 適切な権限管理が動作
- **依存**: Task 1.3
- **推定時間**: 3時間

#### Task 1.5: 認証基盤実装

- [ ] Supabase Auth の設定（Email, Google, Apple）
- [ ] AuthenticationController の実装
- [ ] 認証状態管理（Riverpod）
- [ ] ログイン永続化の実装
- **完了条件**: 各種認証方法が動作
- **依存**: Task 1.2, Task 1.3
- **推定時間**: 4時間

#### Task 1.6: Core UI Components Development ✅

- [x] テーマシステムの実装（AppTheme, Colors, TextStyles）
- [x] 共通ウィジェットの作成（TravueButton, TravueCard, TravueTextField等）
- [x] AppRouter の実装とナビゲーション構造
- [x] レスポンシブレイアウトコンポーネント
- [x] ウィジェットテストの実装
- **完了条件**: 基本UIコンポーネントが実装され、テストが通る ✅
- **依存**: Task 1.1（Clean Architecture実装）
- **推定時間**: 14時間
- **実績**: PR #3で完了

#### Task 1.7: エラーハンドリング基盤

- [ ] エラークラスの定義
- [ ] ErrorHandler の実装
- [ ] グローバルエラーハンドリング
- [ ] エラー通知UIの実装
- **完了条件**: エラーが適切に表示される
- **依存**: Task 1.1
- **推定時間**: 2時間

#### Task 1.8: ローカルストレージ設定

- [ ] SQLite（sqflite）の設定
- [ ] CacheManager の基本実装
- [ ] キャッシュポリシーの定義
- **完了条件**: ローカルキャッシュが動作
- **依存**: Task 1.1
- **推定時間**: 3時間

### Phase 2: 地図・ランドマーク実装（3週間）

#### Task 2.1: flutter_map 統合

- [ ] flutter_map パッケージの設定
- [ ] OpenStreetMap タイル表示
- [ ] 基本的な地図操作（ズーム、パン）
- [ ] MapController の基本実装
- **完了条件**: 地図が表示され操作可能
- **依存**: Task 1.6
- **推定時間**: 3時間

#### Task 2.2: 位置情報サービス実装

- [ ] Geolocator パッケージの設定
- [ ] 権限リクエスト処理
- [ ] 現在位置取得機能
- [ ] 位置情報の継続的な更新
- **完了条件**: 現在位置が取得できる
- **依存**: Task 2.1
- **推定時間**: 3時間

#### Task 2.3: ランドマークデータモデル実装

- [ ] Landmark エンティティクラス
- [ ] LandmarkRepository インターフェース
- [ ] LandmarkRepositoryImpl の実装
- [ ] データ変換処理
- **完了条件**: ランドマークデータの取得が可能
- **依存**: Task 1.3
- **推定時間**: 3時間

#### Task 2.4: 空間検索機能実装

- [ ] PostGIS検索クエリの実装
- [ ] search_landmarks_nearby RPC関数の呼び出し
- [ ] 検索結果のマッピング
- [ ] エラーハンドリング
- **完了条件**: 半径検索が動作
- **依存**: Task 2.3
- **推定時間**: 4時間

#### Task 2.5: 地図マーカー表示

- [ ] LandmarkMarker Widget実装
- [ ] マーカーの動的表示
- [ ] マーカータップイベント処理
- [ ] カスタムマーカーアイコン
- **完了条件**: ランドマークがマーカーとして表示
- **依存**: Task 2.1, Task 2.4
- **推定時間**: 3時間

#### Task 2.6: マーカークラスタリング実装

- [ ] MarkerClusterer クラス実装
- [ ] ズームレベルに応じた表示切替
- [ ] クラスター展開アニメーション
- [ ] パフォーマンス最適化
- **完了条件**: 多数のマーカーが効率的に表示
- **依存**: Task 2.5
- **推定時間**: 4時間

#### Task 2.7: ランドマーク検索UI実装

- [ ] SearchOverlay Widget実装
- [ ] 検索バーUI
- [ ] 検索結果リスト表示
- [ ] 検索履歴機能
- **完了条件**: キーワード検索が可能
- **依存**: Task 2.4
- **推定時間**: 3時間

#### Task 2.8: ランドマークリストパネル実装

- [ ] LandmarkListPanel Widget実装
- [ ] スワイプ可能なボトムシート
- [ ] リストアイテムのデザイン
- [ ] リストと地図の連動
- **完了条件**: ランドマーク一覧が表示可能
- **依存**: Task 2.5
- **推定時間**: 3時間

#### Task 2.9: ランドマーク詳細画面実装

- [ ] LandmarkDetailScreen 実装
- [ ] 基本情報表示（Wikipedia連携）
- [ ] 地域情報表示
- [ ] 投稿一覧への導線
- **完了条件**: ランドマーク詳細が閲覧可能
- **依存**: Task 2.3
- **推定時間**: 4時間

### Phase 3: 投稿機能実装（3週間）

#### Task 3.1: 画像処理基盤実装

- [ ] image_picker パッケージ設定
- [ ] カメラ・ギャラリー権限処理
- [ ] ImageOptimizer クラス実装
- [ ] 画像圧縮処理
- **完了条件**: 写真の撮影・選択が可能
- **依存**: Task 1.1
- **推定時間**: 3時間

#### Task 3.2: Supabase Storage 統合

- [ ] Storage バケット設定
- [ ] 画像アップロード処理
- [ ] StorageService 実装
- [ ] アップロード進捗表示
- **完了条件**: 画像がクラウドに保存される
- **依存**: Task 1.2, Task 3.1
- **推定時間**: 3時間

#### Task 3.3: 投稿データモデル実装

- [ ] Post エンティティクラス
- [ ] PostRepository インターフェース
- [ ] PostRepositoryImpl 実装
- [ ] 投稿データの CRUD 操作
- **完了条件**: 投稿データの管理が可能
- **依存**: Task 1.3
- **推定時間**: 3時間

#### Task 3.4: 投稿作成画面実装

- [ ] CreatePostScreen 実装
- [ ] 写真選択・プレビューUI
- [ ] テキスト入力フォーム
- [ ] ランドマーク選択UI
- **完了条件**: 投稿作成フォームが動作
- **依存**: Task 3.1, Task 2.3
- **推定時間**: 4時間

#### Task 3.5: 投稿コントローラー実装

- [ ] PostController 実装
- [ ] 投稿作成フロー
- [ ] バリデーション処理
- [ ] 状態管理（Riverpod）
- **完了条件**: 投稿の作成が完了できる
- **依存**: Task 3.3, Task 3.4
- **推定時間**: 3時間

#### Task 3.6: 投稿表示機能実装

- [ ] PostCard Widget実装
- [ ] 画像キャッシング（cached_network_image）
- [ ] 投稿者情報表示
- [ ] いいね・コメント UI（基本のみ）
- **完了条件**: 投稿が適切に表示される
- **依存**: Task 3.3
- **推定時間**: 3時間

#### Task 3.7: 投稿一覧表示実装

- [ ] 投稿一覧の取得処理
- [ ] 無限スクロール実装
- [ ] プルリフレッシュ
- [ ] ローディング・エラー表示
- **完了条件**: 投稿一覧が閲覧可能
- **依存**: Task 3.6
- **推定時間**: 3時間

### Phase 4: ガイドブック機能実装（4週間）

#### Task 4.1: ガイドブックデータモデル実装

- [ ] Guide エンティティクラス
- [ ] GuideItem エンティティクラス
- [ ] GuideRepository インターフェース
- [ ] GuideRepositoryImpl 実装
- **完了条件**: ガイドブックデータの管理が可能
- **依存**: Task 1.3
- **推定時間**: 3時間

#### Task 4.2: ガイドブック作成画面基本実装

- [ ] CreateGuideScreen 実装
- [ ] タイトル・説明入力UI
- [ ] 表紙画像選択
- [ ] タグ入力機能
- **完了条件**: ガイドブックの基本情報が入力可能
- **依存**: Task 4.1, Task 3.1
- **推定時間**: 4時間

#### Task 4.3: スポット選択機能実装

- [ ] スポット検索・選択UI
- [ ] 選択済みスポット一覧
- [ ] ドラッグ&ドロップによる並び替え
- [ ] スポットごとのメモ機能
- **完了条件**: スポットの選択と並び替えが可能
- **依存**: Task 4.2, Task 2.3
- **推定時間**: 4時間

#### Task 4.4: ガイドブックコントローラー実装

- [ ] GuideController 実装
- [ ] ガイドブック作成・更新処理
- [ ] 公開設定処理
- [ ] 状態管理（Riverpod）
- **完了条件**: ガイドブックの作成が完了できる
- **依存**: Task 4.1, Task 4.3
- **推定時間**: 3時間

#### Task 4.5: ガイドブック詳細画面実装

- [ ] GuideDetailScreen 実装
- [ ] 表紙・基本情報表示
- [ ] スポット一覧表示
- [ ] 地図連動表示
- **完了条件**: ガイドブックの詳細が閲覧可能
- **依存**: Task 4.1, Task 2.1
- **推定時間**: 4時間

#### Task 4.6: ガイドブック一覧画面実装

- [ ] 公開ガイドブック一覧取得
- [ ] カテゴリ・タグフィルター
- [ ] 人気順・新着順ソート
- [ ] グリッド表示UI
- **完了条件**: ガイドブック一覧が閲覧可能
- **依存**: Task 4.1
- **推定時間**: 3時間

#### Task 4.7: プロフィール画面実装

- [ ] ProfileScreen 実装
- [ ] ユーザー情報表示
- [ ] 作成したガイドブック一覧
- [ ] 投稿履歴表示
- **完了条件**: プロフィール情報が表示される
- **依存**: Task 1.5, Task 4.1, Task 3.3
- **推定時間**: 3時間

#### Task 4.8: ホーム画面実装

- [ ] HomeScreen 実装
- [ ] 人気ガイドブック表示
- [ ] おすすめ投稿者表示
- [ ] 各機能への導線設置
- **完了条件**: アプリのエントリーポイントが完成
- **依存**: Task 4.6, Task 3.7
- **推定時間**: 3時間

### Phase 5: 統合・最適化（1週間）

#### Task 5.1: オフライン対応実装

- [ ] 重要データのローカルキャッシュ
- [ ] オフライン時の動作制御
- [ ] 同期処理の実装
- [ ] 同期状態の表示
- **完了条件**: オフラインでも基本機能が使える
- **依存**: Task 1.8, 各機能実装
- **推定時間**: 4時間

#### Task 5.2: パフォーマンス最適化

- [ ] 画像遅延読み込み最適化
- [ ] リスト表示の仮想化
- [ ] メモリ使用量の最適化
- [ ] 起動時間の短縮
- **完了条件**: パフォーマンス要件を満たす
- **依存**: 全機能実装
- **推定時間**: 4時間

#### Task 5.3: E2Eテスト実装

- [ ] 認証フローのE2Eテスト
- [ ] 投稿作成フローのテスト
- [ ] ガイドブック作成フローのテスト
- [ ] 統合テストの自動化
- **完了条件**: 主要フローがテストでカバーされる
- **依存**: 全機能実装
- **推定時間**: 4時間

#### Task 5.4: リリース準備

- [ ] アプリアイコン・スプラッシュ画面
- [ ] ビルド設定の最終調整
- [ ] App Store / Google Play 向け設定
- [ ] リリースビルドの作成
- **完了条件**: ストア提出可能な状態
- **依存**: Task 5.2, Task 5.3
- **推定時間**: 3時間

## 実装順序

1. Phase 1を完了（基盤がないと他の実装ができない）
2. Phase 2とPhase 3は一部並行実行可能
   - Task 3.1〜3.2（画像処理）はPhase 2と並行可能
3. Phase 4はPhase 2, 3の主要機能完了後
4. Phase 5は全機能実装後

## リスクと対策

- **PostGIS の学習コスト**: 早期にプロトタイプで検証を実施
- **画像アップロードのパフォーマンス**: 段階的な最適化とフィードバック収集
- **オフライン同期の複雑性**: MVPでは簡易実装とし、段階的に改善

## 注意事項

- 各タスクは可能な限り独立してコミット可能な単位にする
- タスク完了時は必ず動作確認とコードレビューを実施
- 不明点は実装前に技術調査タスクを追加する
- PoC要件を優先し、追加機能は後回しにする

## 実装開始ガイド

1. このタスクリストに従って順次実装を進めてください
2. 各タスクの開始時にTodoWriteでin_progressに更新
3. 完了時はcompletedに更新
4. 問題発生時は速やかに報告してください
5. 毎週金曜日に進捗確認とタスクの見直しを実施